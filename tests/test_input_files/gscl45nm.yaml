# Adapted from https://codeberg.org/tok/liberty-parser/src/branch/master/test_data/gscl45nm.lib
# technology library, collection of gates along with other characteristics
library:
  name: "gsc145nm"
  delay_model: "table_lookup"
  in_place_swap_mode: "match_footprint"
  # unit attributes
  time_unit: "1ns"
  voltage_unit: "1V"
  current_unit: "1uA"
  pulling_resistance_unit: "1kohm"
  leakage_power_unit: "1nW"
  capacitive_load_unit: 
    value: 1
    unit: "pf"
  slew_upper_threshold_pct_rise: 80
  slew_lower_threshold_pct_rise: 20
  slew_upper_threshold_pct_fall: 80
  slew_lower_threshold_pct_fall: 20
  input_threshold_pct_rise: 50
  input_threshold_pct_fall: 50
  output_threshold_pct_rise: 50
  output_threshold_pct_fall: 50
  nom_process: 1
  nom_voltage: 1.1
  nom_temperature: 27
  operating_conditions:
    name: "typical"
    process: 1
    voltage: 1.1
    temperature: 27
  # TODO - figure out if the "typical" value here references the operating_conditions (meaning var or just a string)
  # my guess is that it probably means something to whatever uses the .lib file, but I don't think it means anything when i'm writing the code
  default_operating_conditions: "typical"

  lu_table_templates:
    - type: "lu_table_template"
      name: "delay_template_4x5"
      variable_1: "total_output_net_capacitance"
      variable_2: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0]
    - type: "lu_table_template"
      name: "delay_template_5x1"
      variable_1: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0]
    - type: "lu_table_template"
      name: "delay_template_6x1"
      variable_1: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "delay_template_6x6"
      variable_1: "total_output_net_capacitance"
      variable_2: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "delay_template_6x6"
      variable_1: "total_output_net_capacitance"
      variable_2: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "power_lut_template"
      name: "energy_template_4x5"
      variable_1: "total_output_net_capacitance"
      variable_2: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0]
    - type: "power_lut_template"
      name: "energy_template_6x6"
      variable_1: "total_output_net_capacitance"
      variable_2: "input_net_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "hold_template_3x6"
      variable_1: "related_pin_transition"
      variable_2: "constrained_pin_transition"
      index_1: [1000.0, 1001.0, 1002.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "power_lut_template"
      name: "passive_energy_template_5x1"
      variable_1: "input_transition_time"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0]
    - type: "power_lut_template"
      name: "passive_energy_template_6x1"
      variable_1: "input_transition_time"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "recovery_template_3x6"
      variable_1: "related_pin_transition"
      variable_2: "constrained_pin_transition"
      index_1: [1000.0, 1001.0, 1002.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "recovery_template_6x6"
      variable_1: "related_pin_transition"
      variable_2: "constrained_pin_transition"
      index_1: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "removal_template_3x6"
      variable_1: "related_pin_transition"
      variable_2: "constrained_pin_transition"
      index_1: [1000.0, 1001.0, 1002.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]
    - type: "lu_table_template"
      name: "setup_template_3x6"
      variable_1: "related_pin_transition"
      variable_2: "constrained_pin_transition"
      index_1: [1000.0, 1001.0, 1002.0]
      index_2: [1000.0, 1001.0, 1002.0, 1003.0, 1004.0, 1005.0]

  # TODO - this structure likely needs to change when bused pins are included in the structure/whenever other changes need to be made
  # for now, i'll do a simple BUFX2
  cells:
  - name: "BUFX2"
    cell_footprint: "buf"
    area: 2.346500
    cell_leakage_power: 19.7536
    pins:
    - name: "A"
      direction: "input"
      capacitance: 0.00153896
      rise_capacitance: 0.00153896
      fall_capacitance: 0.00150415
    - name: "Y"
      direction: "output"
      capacitance: 0
      rise_capacitance: 0
      fall_capacitance: 0
      max_capacitance: 0.518678
      function: "A"
      timings:
      - related_pin: "A"
        timing_sense: "positive_unate"
        cell_rise:
          cell_template: "delay_template_4x5"
          index_1: [0.02, 0.04, 0.08, 0.2]
          index_2: [0.06, 0.18, 0.42, 0.6, 1.2]
          values:
          - [0.063943, 0.071963, 0.027516, 0.082034, 0.066059]
          - [0.094187, 0.099356, 0.0635, 0.002776, -0.064928]
          - [0.156904, 0.158037, 0.133819, 0.088328, -0.001681]
          - [0.346685, 0.343572, 0.311057, 0.266532, 0.221543]
        rise_transition: 
          cell_template: "delay_template_4x5"
          index_1: [0.02, 0.04, 0.08, 0.2]
          index_2: [0.06, 0.18, 0.42, 0.6, 1.2]
          values:
          - [0.052895, 0.063171, 0.145667, 0.090511, 0.135315]
          - [0.097952, 0.100743, 0.165668, 0.223096, 0.347827]
          - [0.192592, 0.189413, 0.227832, 0.275388, 0.40565]
          - [0.47767, 0.465699, 0.473121, 0.485414, 0.578887]
        cell_fall:
          index_1: [0.02, 0.04, 0.08, 0.2]
          index_2: [0.06, 0.18, 0.42, 0.6, 1.2]
          values: 
          - [0.061896, 0.087295, 0.122815, 0.05382, 0.114433]
          - [0.083181, 0.109743, 0.132926, 0.06208, 0.122644]
          - [0.123383, 0.148916, 0.158043, 0.084818, 0.140278]
          - [0.244802, 0.268345, 0.295462, 0.229634, 0.211325]
        fall_transition:
          index_1: [0.02, 0.04, 0.08, 0.2]
          index_2: [0.06, 0.18, 0.42, 0.6, 1.2]
          values: 
          - [0.034243, 0.052368, 0.210073, 0.250768, 0.483235]
          - [0.059201, 0.069831, 0.217597, 0.256839, 0.489242]
          - [0.115169, 0.116317, 0.239017, 0.273588, 0.502134]
          - [0.28636, 0.28105, 0.33743, 0.369142, 0.563601]
      internal_powers:
      - related_pin: "B"
        rise_power: 
          cell_template: "energy_template_6x6"
          index_1: [0.1, 0.5, 1.2, 3, 4, 5]
          index_2: [0.06, 0.24, 0.48, 0.9, 1.2, 1.8]
          values:
          - [0.007629, 0.007814, 0.008527, 0.011, 0.013036, 0.021415]
          - [0.007847, 0.007969, 0.008127, 0.008954, 0.01012, 0.013793]
          - [0.007598, 0.007574, 0.008075, 0.008447, 0.009083, 0.011614]
          - [0.008148, 0.008291, 0.008042, 0.008235, 0.008524, 0.009792]
          - [0.007902, 0.007896, 0.008061, 0.008321, 0.008456, 0.009447]
          - [0.008154, 0.008144, 0.008174, 0.008374, 0.008494, 0.009334]
        fall_power: 
          cell_template: "energy_template_6x6"
          index_1: [0.1, 0.5, 1.2, 3, 4, 5]
          index_2: [0.06, 0.24, 0.48, 0.9, 1.2, 1.8]
          values:
          - [0.00604, 0.00546, 0.004522, 0.008066, 0.008138, 0.013239]
          - [0.006515, 0.006262, 0.005731, 0.005975, 0.005628, 0.009725]
          - [0.006768, 0.006514, 0.00628, 0.006416, 0.00616, 0.009504]
          - [0.006658, 0.006511, 0.006592, 0.006587, 0.006616, 0.008255]
          - [0.006618, 0.006678, 0.006494, 0.006732, 0.006602, 0.007908]
          - [0.00683, 0.006673, 0.006518, 0.006744, 0.006617, 0.007681]
      - related_pin: "A"
        rise_power:
          cell_template: "energy_template_6x6"
          index_1: [0.1, 0.5, 1.2, 3, 4, 5]
          index_2: [0.06, 0.24, 0.48, 0.9, 1.2, 1.8]
          values:
          - [0.009297, 0.00938, 0.010122, 0.012505, 0.01485, 0.02392]
          - [0.00961, 0.009725, 0.009557, 0.010635, 0.011974, 0.015581]
          - [0.009172, 0.009196, 0.009463, 0.009996, 0.010718, 0.013328]
          - [0.009608, 0.009884, 0.009619, 0.009753, 0.009964, 0.011293]
          - [0.00926, 0.009082, 0.009411, 0.009783, 0.009933, 0.010963]
          - [0.009509, 0.009478, 0.009613, 0.009706, 0.009911, 0.010674]
        fall_power:
          cell_template: "energy_template_6x6"
          index_1: [0.1, 0.5, 1.2, 3, 4, 5]
          index_2: [0.06, 0.24, 0.48, 0.9, 1.2, 1.8]
          values:
          - [0.006072, 0.00541, 0.006178, 0.009189, 0.011797, 0.017137]
          - [0.006493, 0.006567, 0.006148, 0.006827, 0.007586, 0.009818]
          - [0.006532, 0.006451, 0.006606, 0.00661, 0.007228, 0.007937]
          - [0.006595, 0.006709, 0.006508, 0.006694, 0.006752, 0.007246]
          - [0.006876, 0.00663, 0.006553, 0.006934, 0.006829, 0.00718]
          - [0.006448, 0.006767, 0.006583, 0.006766, 0.006847, 0.007]

#  - name: "AND2X1"
#    area: 2.346500
#    cell_leakage_power: 15.6059
#    pins: 
#    - name: "A"
#      direction: "input"
#      capacitance: 0.00229149
#      rise_capacitance: 0.00229149
#      fall_capacitance: 0.00187144
#    - name: "B"
#      direction: "input"
#      capacitance: 0.00234289
#      rise_capacitance: 0.00234289
#      fall_capacitance: 0.00182664
#    - name: "Y"
#      direction: "output"
#      capacitance: 0
#      rise_capacitance: 0
#      max_capacitance: 0.137429
#      function: "(A B)"
#      timing:
#      - related_pin: "A"
#        timing_sense: "positive_unate"
#        cell_rise: 
#          cell_template: "delay_template_6x6"
#          index_1: [0.1, 0.5, 1.2, 3, 4, 5]
#          index_2: [0.06, 0.24, 0.48, 0.9, 1.2, 1.8]
#          # TODO - are these determined by other values located in the file? it would be way easier to calculate than to have someone manually type out these values
#          values:
#          - [0.335241, 0.33337, 0.277585, 0.287249, 0.244978, 0.011983]
#          - [1.58383, 1.58134, 1.53432, 1.52558, 1.47083, 1.24723]
#          - [3.74896, 3.78881, 3.71652, 3.6962, 3.64991, 3.44354]
#          # remaining lists would go here, 2d indexing makes sense now!